Version 4
SHEET 1 3232 1588
WIRE 1968 -1216 1856 -1216
WIRE 2096 -1200 2032 -1200
WIRE 1968 -1184 1856 -1184
WIRE 1984 -1008 1872 -1008
WIRE 112 -992 96 -992
WIRE 224 -992 192 -992
WIRE 2112 -992 2048 -992
WIRE 1984 -976 1872 -976
WIRE -16 -928 -48 -928
WIRE 96 -928 96 -992
WIRE 96 -928 64 -928
WIRE 96 -912 96 -928
WIRE 128 -912 96 -912
WIRE 816 -912 784 -912
WIRE 944 -912 896 -912
WIRE 1008 -912 944 -912
WIRE 224 -896 224 -992
WIRE 224 -896 192 -896
WIRE 256 -896 224 -896
WIRE 128 -880 96 -880
WIRE 944 -880 944 -912
WIRE -16 -864 -48 -864
WIRE 96 -864 96 -880
WIRE 96 -864 64 -864
WIRE 96 -848 96 -864
WIRE -864 -800 -1008 -800
WIRE -672 -800 -864 -800
WIRE -416 -800 -672 -800
WIRE 944 -784 944 -816
WIRE -672 -768 -672 -800
WIRE -416 -752 -416 -800
WIRE 1472 -736 1392 -736
WIRE 1536 -736 1520 -736
WIRE 1552 -736 1536 -736
WIRE 1648 -736 1632 -736
WIRE 1680 -736 1648 -736
WIRE 1776 -736 1680 -736
WIRE 2112 -736 2032 -736
WIRE 2272 -736 2112 -736
WIRE 2384 -736 2272 -736
WIRE 96 -720 96 -768
WIRE -1008 -656 -1008 -800
WIRE -672 -656 -672 -688
WIRE 2384 -624 2384 -736
WIRE -416 -592 -416 -672
WIRE -304 -592 -416 -592
WIRE -288 -592 -304 -592
WIRE 1648 -576 1648 -736
WIRE 2112 -576 2112 -736
WIRE -416 -544 -416 -592
WIRE -672 -528 -672 -576
WIRE -560 -528 -672 -528
WIRE -544 -528 -560 -528
WIRE -672 -512 -672 -528
WIRE -1008 -416 -1008 -576
WIRE -848 -416 -1008 -416
WIRE -672 -416 -672 -432
WIRE -672 -416 -848 -416
WIRE -416 -416 -416 -464
WIRE -416 -416 -672 -416
WIRE 1424 -416 1392 -416
WIRE 1648 -416 1648 -512
WIRE 1648 -416 1424 -416
WIRE 1904 -416 1904 -640
WIRE 1904 -416 1648 -416
WIRE 2112 -416 2112 -512
WIRE 2112 -416 1904 -416
WIRE 2384 -416 2384 -544
WIRE 2384 -416 2112 -416
WIRE 1424 -400 1424 -416
WIRE 112 -352 96 -352
WIRE 224 -352 192 -352
WIRE -16 -288 -48 -288
WIRE 96 -288 96 -352
WIRE 96 -288 64 -288
WIRE 96 -272 96 -288
WIRE 128 -272 96 -272
WIRE 832 -272 800 -272
WIRE 960 -272 912 -272
WIRE 1024 -272 960 -272
WIRE 224 -256 224 -352
WIRE 224 -256 192 -256
WIRE 256 -256 224 -256
WIRE 128 -240 96 -240
WIRE 960 -240 960 -272
WIRE -16 -224 -48 -224
WIRE 96 -224 96 -240
WIRE 96 -224 64 -224
WIRE 96 -208 96 -224
WIRE 960 -144 960 -176
WIRE 96 -96 96 -128
WIRE 1408 96 1408 16
WIRE 1536 192 1536 128
WIRE 1584 192 1536 192
WIRE 1744 208 1648 208
WIRE 1408 224 1408 176
WIRE 1584 224 1408 224
WIRE 1408 272 1408 224
WIRE 1408 480 1408 352
FLAG 960 -144 0
FLAG 800 -272 Vvo
FLAG 1024 -272 Vvsfilter
FLAG 160 -864 0
FLAG 160 -928 5V
FLAG -48 -864 Vis
FLAG -48 -928 0
FLAG 256 -896 Vio
FLAG 160 -224 0
FLAG 160 -288 5V
FLAG -48 -288 0
FLAG 256 -256 Vvo
FLAG 1424 -400 0
FLAG 1392 -736 Vac
FLAG 2272 -736 5VDis
FLAG 1680 -736 Vin
FLAG -48 -1184 0
FLAG -48 -1264 5V
FLAG 944 -784 0
FLAG 784 -912 Vio
FLAG 1008 -912 Visfilter
FLAG 2000 -1168 0
FLAG 2000 -1232 5V
FLAG 2096 -1200 Vvsout
FLAG 1856 -1184 Vvsfilter
FLAG 1408 480 0
FLAG 1408 16 5V
FLAG 1744 208 Vref
FLAG 1616 240 0
FLAG 1616 176 5V
FLAG 96 -96 Vref
FLAG 96 -720 Vref
FLAG 1856 -1216 Vref
FLAG -48 -224 Vvs
FLAG 2016 -960 0
FLAG 2016 -1024 5V
FLAG 2112 -992 Visout
FLAG 1872 -976 Visfilter
FLAG 1872 -1008 Vref
FLAG 1536 128 Vref
FLAG -848 -416 0
FLAG -864 -800 Vac
FLAG -560 -528 Vis
FLAG -304 -592 Vvs
SYMBOL res 928 -288 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf1
SYMATTR Value 100k
SYMBOL cap 976 -176 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf1
SYMATTR Value 0.16nF
SYMBOL Opamps/opamp2 160 -960 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res 80 -880 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 80 -944 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 208 -1008 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R3
SYMATTR Value 22k
SYMBOL res 112 -752 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R4
SYMATTR Value 22k
SYMBOL Opamps/opamp2 160 -320 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL res 80 -304 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 208 -368 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 112 -112 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL PowerProducts/LT1085-5 1904 -736 R0
SYMATTR InstName Reg1
SYMBOL res 2368 -640 R0
SYMATTR InstName RL1
SYMATTR Value 150
SYMBOL diode 1472 -720 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap 1632 -576 R0
WINDOW 0 37 39 Left 2
SYMATTR InstName Cin1
SYMATTR Value 66.67µF
SYMBOL cap 2096 -576 R0
SYMATTR InstName Cout1
SYMATTR Value 10µF
SYMBOL voltage -48 -1280 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5VDis
SYMBOL res 912 -928 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 6250
SYMBOL cap 960 -816 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf2
SYMATTR Value 16nF
SYMBOL Opamps/opamp2 2000 -1264 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 1392 256 R0
SYMATTR InstName R16
SYMATTR Value 39k
SYMBOL res 1392 80 R0
SYMATTR InstName R17
SYMATTR Value 56k
SYMBOL Opamps/opamp2 1616 144 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL Opamps/opamp2 2016 -1056 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U5
SYMATTR Value LM324
SYMBOL res 1536 -720 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R10
SYMATTR Value 20
SYMBOL res 80 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL voltage -1008 -672 R0
WINDOW 0 24 96 Left 2
WINDOW 3 23 120 Left 2
WINDOW 123 25 141 Left 2
WINDOW 39 0 0 Left 0
SYMATTR InstName Vsupply2
SYMATTR Value SINE(0 19.8 500)
SYMATTR Value2 AC 1
SYMBOL res -688 -672 R0
SYMATTR InstName Rload2
SYMATTR Value 93.666
SYMBOL ind -688 -784 R0
SYMATTR InstName Lload2
SYMATTR Value 4mH
SYMBOL res -688 -528 R0
SYMATTR InstName Rs2
SYMATTR Value 0.56
SYMBOL res -432 -768 R0
SYMATTR InstName Ra2
SYMATTR Value 56k
SYMBOL res -432 -560 R0
SYMATTR InstName Rb2
SYMATTR Value 2.7k
TEXT -56 -1368 Left 2 ;Power/Signal Sources
TEXT 816 -1248 Left 2 ;.ac dec 30 1 1Meg
TEXT 816 -1312 Left 2 !.lib LM324.lib
TEXT 808 -1376 Left 2 ;Simulation Commands\n- Change these as needed
TEXT 816 -1280 Left 2 !.tran 0 200m 0 0.01m
TEXT 816 -1216 Left 2 !.ic V(Vin)=8
TEXT -928 -328 Left 2 ;Supply a max voltage around 14V rms
TEXT -48 -1088 Left 2 ;Level-shifting and amplification for current sensor
TEXT -40 -448 Left 2 ;Level-shifting and amplification of Voltage sensor
TEXT 816 -1168 Left 2 !;ac dec 30 1 1Meg
TEXT 592 -984 Left 2 ;Current sensor connecting to the current sensor filter
TEXT 608 -344 Left 2 ;Voltage sensor connecting to the voltage sensor filter
TEXT 1512 56 Left 2 ;Circuit generating Offset
TEXT 1832 -1312 Left 2 ;Comparator for Vvs filter
TEXT 1392 544 Left 2 ;This cct generates a rough 2.1V offset
TEXT -928 -288 Left 2 ;The Voltage drop across Rs1 is proportional to the currnet.
TEXT -920 -248 Left 2 ;Using I = V/R current can be calculated
TEXT -96 -624 Left 2 ;Generate a rough 2.1V offset and a rough 1V pk wave.
TEXT -720 -760 Right 2 ;Load \n(2.5VA-7.5VA)
TEXT -720 -472 Right 2 ;Current Sens \n(Pmax=?)
TEXT -1008 -872 Left 2 ;Voltage and current sensing circuit design
TEXT 784 -760 Left 2 ;??????
RECTANGLE Normal 792 -1392 1228 -1188 2
RECTANGLE Normal -712 -780 -584 -564 2
RECTANGLE Normal -712 -536 -584 -424 2
RECTANGLE Normal -468 -828 -332 -392 2
