Version 4
SHEET 1 4568 1588
WIRE -864 -800 -1008 -800
WIRE -672 -800 -864 -800
WIRE -416 -800 -672 -800
WIRE 624 -800 592 -800
WIRE 752 -800 704 -800
WIRE 816 -800 752 -800
WIRE 16 -784 0 -784
WIRE 128 -784 96 -784
WIRE -672 -768 -672 -800
WIRE 752 -768 752 -800
WIRE 3120 -768 3008 -768
WIRE -416 -752 -416 -800
WIRE 3248 -752 3184 -752
WIRE 1264 -736 1184 -736
WIRE 1328 -736 1312 -736
WIRE 1344 -736 1328 -736
WIRE 1440 -736 1424 -736
WIRE 1472 -736 1440 -736
WIRE 1568 -736 1472 -736
WIRE 1904 -736 1824 -736
WIRE 2064 -736 1904 -736
WIRE 2176 -736 2064 -736
WIRE 3120 -736 3008 -736
WIRE -112 -720 -144 -720
WIRE 0 -720 0 -784
WIRE 0 -720 -32 -720
WIRE 0 -704 0 -720
WIRE 32 -704 0 -704
WIRE 2400 -704 2400 -784
WIRE 128 -688 128 -784
WIRE 128 -688 96 -688
WIRE 160 -688 128 -688
WIRE 32 -672 0 -672
WIRE 752 -672 752 -704
WIRE -1008 -656 -1008 -800
WIRE -672 -656 -672 -688
WIRE -112 -656 -144 -656
WIRE 0 -656 0 -672
WIRE 0 -656 -32 -656
WIRE 0 -640 0 -656
WIRE 2176 -624 2176 -736
WIRE 2528 -608 2528 -672
WIRE 2576 -608 2528 -608
WIRE -416 -592 -416 -672
WIRE -304 -592 -416 -592
WIRE -288 -592 -304 -592
WIRE 2736 -592 2640 -592
WIRE 1440 -576 1440 -736
WIRE 1904 -576 1904 -736
WIRE 2400 -576 2400 -624
WIRE 2576 -576 2400 -576
WIRE -416 -544 -416 -592
WIRE -672 -528 -672 -576
WIRE -560 -528 -672 -528
WIRE -544 -528 -560 -528
WIRE 2400 -528 2400 -576
WIRE -672 -512 -672 -528
WIRE 0 -512 0 -560
WIRE -1008 -416 -1008 -576
WIRE -848 -416 -1008 -416
WIRE -672 -416 -672 -432
WIRE -672 -416 -848 -416
WIRE -416 -416 -416 -464
WIRE -416 -416 -672 -416
WIRE 1216 -416 1184 -416
WIRE 1440 -416 1440 -512
WIRE 1440 -416 1216 -416
WIRE 1696 -416 1696 -640
WIRE 1696 -416 1440 -416
WIRE 1904 -416 1904 -512
WIRE 1904 -416 1696 -416
WIRE 2176 -416 2176 -544
WIRE 2176 -416 1904 -416
WIRE 1216 -400 1216 -416
WIRE 3120 -400 3008 -400
WIRE 3248 -384 3184 -384
WIRE 3120 -368 3008 -368
WIRE 624 -336 592 -336
WIRE 752 -336 704 -336
WIRE 816 -336 752 -336
WIRE 16 -320 0 -320
WIRE 128 -320 96 -320
WIRE 2400 -320 2400 -448
WIRE 752 -304 752 -336
WIRE -112 -256 -144 -256
WIRE 0 -256 0 -320
WIRE 0 -256 -32 -256
WIRE 0 -240 0 -256
WIRE 32 -240 0 -240
WIRE 128 -224 128 -320
WIRE 128 -224 96 -224
WIRE 160 -224 128 -224
WIRE 32 -208 0 -208
WIRE 752 -208 752 -240
WIRE -112 -192 -144 -192
WIRE 0 -192 0 -208
WIRE 0 -192 -32 -192
WIRE 0 -176 0 -192
WIRE -1120 -144 -1120 -1072
WIRE -224 -144 -224 -1072
WIRE 352 -144 352 -1072
WIRE 1088 -144 1088 -1072
WIRE 2288 -144 2288 -1072
WIRE 2848 -144 2848 -1072
WIRE 3376 -144 3376 -1072
WIRE 0 -64 0 -96
FLAG 752 -208 0
FLAG 592 -336 Vvo
FLAG 816 -336 Vvsfilter
FLAG 64 -656 0
FLAG 64 -720 5V
FLAG -144 -656 Vis
FLAG -144 -720 0
FLAG 160 -688 Vio
FLAG 64 -192 0
FLAG 64 -256 5V
FLAG -144 -256 0
FLAG 160 -224 Vvo
FLAG 1216 -400 0
FLAG 1184 -736 Vac
FLAG 2064 -736 5VDis
FLAG 1472 -736 Vin
FLAG -112 -1312 0
FLAG -112 -1392 5V
FLAG 752 -672 0
FLAG 592 -800 Vio
FLAG 816 -800 Visfilter
FLAG 3152 -352 0
FLAG 3152 -416 5V
FLAG 3248 -384 Vvsout
FLAG 3008 -368 Vvsfilter
FLAG 2400 -320 0
FLAG 2400 -784 5V
FLAG 2736 -592 Vref
FLAG 2608 -560 0
FLAG 2608 -624 5V
FLAG 0 -64 Vref
FLAG 0 -512 Vref
FLAG 3008 -400 Vref
FLAG -144 -192 Vvs
FLAG 3152 -720 0
FLAG 3152 -784 5V
FLAG 3248 -752 Visout
FLAG 3008 -736 Visfilter
FLAG 3008 -768 Vref
FLAG 2528 -672 Vref
FLAG -848 -416 0
FLAG -864 -800 Vac
FLAG -560 -528 Vis
FLAG -304 -592 Vvs
SYMBOL res 720 -352 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf1
SYMATTR Value 100k
SYMBOL cap 768 -240 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf1
SYMATTR Value 0.16n
SYMBOL Opamps/opamp2 64 -752 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res -16 -672 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res -16 -736 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 112 -800 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R3
SYMATTR Value 22k
SYMBOL res 16 -544 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R4
SYMATTR Value 22k
SYMBOL Opamps/opamp2 64 -288 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL res -16 -272 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 112 -336 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 16 -80 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL PowerProducts/LT1085-5 1696 -736 R0
SYMATTR InstName Reg1
SYMBOL res 2160 -640 R0
SYMATTR InstName RL1
SYMATTR Value 150
SYMBOL diode 1264 -720 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap 1424 -576 R0
WINDOW 0 37 39 Left 2
SYMATTR InstName Cin1
SYMATTR Value 66.67µF
SYMBOL cap 1888 -576 R0
SYMATTR InstName Cout1
SYMATTR Value 10µF
SYMBOL voltage -112 -1408 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5VDis
SYMBOL res 720 -816 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 10k
SYMBOL cap 768 -704 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf2
SYMATTR Value 0.16n
SYMBOL Opamps/opamp2 3152 -448 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 2384 -544 R0
SYMATTR InstName R16
SYMATTR Value 39k
SYMBOL res 2384 -720 R0
SYMATTR InstName R17
SYMATTR Value 56k
SYMBOL Opamps/opamp2 2608 -656 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL Opamps/opamp2 3152 -816 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U5
SYMATTR Value LM324
SYMBOL res 1328 -720 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R10
SYMATTR Value 20
SYMBOL res -16 -208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL voltage -1008 -672 R0
WINDOW 0 24 96 Left 2
WINDOW 3 23 120 Left 2
WINDOW 123 25 141 Left 2
WINDOW 39 0 0 Left 0
SYMATTR InstName Vsupply2
SYMATTR Value SINE(0 19.8 500)
SYMATTR Value2 AC 1
SYMBOL res -688 -672 R0
SYMATTR InstName Rload2
SYMATTR Value 76.83
SYMBOL ind -688 -784 R0
SYMATTR InstName Lload2
SYMATTR Value 4mH
SYMBOL res -688 -528 R0
SYMATTR InstName Rs2
SYMATTR Value 0.56
SYMBOL res -432 -768 R0
SYMATTR InstName Ra2
SYMATTR Value 56k
SYMBOL res -432 -560 R0
SYMATTR InstName Rb2
SYMATTR Value 2.7k
TEXT -256 -1472 Left 3 ;Power/Signal Source
TEXT 160 -1360 Left 2 ;.ac dec 30 1 1Meg
TEXT 160 -1424 Left 2 !.lib LM324.lib
TEXT 160 -1472 Left 3 ;Simulation Commands
TEXT 160 -1392 Left 2 !.tran 0 200m 0 0.01m
TEXT 160 -1328 Left 2 !.ic V(Vin)=8
TEXT -1008 -336 Left 2 ;Supply a max voltage around 14V rms
TEXT -96 -872 Center 2 ;Current sensor
TEXT -96 -408 Center 2 ;Voltage sensor
TEXT 160 -1280 Left 2 !;ac dec 30 1 1Meg
TEXT 712 -872 Center 2 ;Current sensor connecting to the current sensor filter
TEXT 712 -408 Center 2 ;Voltage sensor connecting to the voltage sensor filter
TEXT 3088 -976 Center 3 ;Comparators
TEXT 2568 -232 Center 2 ;This circuit generates a rough 2.1V offset \nwhich we use as the Reference Voltage
TEXT -1008 -296 Left 2 ;The Voltage drop across Rs1 is proportional to the currnet.
TEXT -1000 -256 Left 2 ;Using I = V/R current can be calculated
TEXT 32 16 Center 2 ;The voltage sensor amplification circuit \ngenerates a rough 2.1V offset and a \nrough 1V pk wave.
TEXT -720 -760 Right 2 ;Load \n(2.5VA-7.5VA)
TEXT -720 -472 Right 2 ;Current Sens \n(Pmax=?)
TEXT -704 -976 Center 3 ;Voltage and current sensing circuit design
TEXT 3112 -288 Center 2 ;This comparator triggers positively \nwhen Vvsfilter greater than Vref
TEXT 3112 -656 Center 2 ;This comparator triggers positively \nwhen Visfilter greater than Vref
TEXT 688 16 Center 2 ;Low pass RC filter that allows frequencies under \n10kHz which is our cutoff frequency
TEXT 56 -976 Center 3 ;Level-shifting and amplifications
TEXT 744 -976 Center 3 ;Filters
TEXT 1696 -976 Center 3 ;Regulator
TEXT 2568 -976 Center 3 ;Reference Voltage \n(using voltage divider)
TEXT -1008 -80 Left 2 ;93.666 Rload was for 15.4Vrms\n76.83 Rload is for when 2.5VA with 14Vrms\n22.354 Rload is for when 7.5VA with 14Vrms
RECTANGLE Normal 136 -1504 572 -1300 2
RECTANGLE Normal -712 -780 -584 -564 2
RECTANGLE Normal -712 -536 -584 -424 2
RECTANGLE Normal -468 -828 -332 -392 2
